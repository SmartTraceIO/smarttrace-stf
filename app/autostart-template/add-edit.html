<div class="portlet box green " ng-init="Init()">
    <div class="portlet-title">
        <div class="caption">
            <img style="margin-top:-8px" src="../../theme/img/headerAutostartTemplate.png" /> {{Action}} an autostart templates
        </div>
    </div>
    <div class="portlet-body form">
        <form role="form" name="frmAddEditTemplate" class="form-horizontal">
            <div class="form-body">
                <div class="form-group">
                    <div class="col-sm-offset-4 col-sm-4">
                        <label class="control-label pull-left">Autostart Shipment Template Name:&nbsp;
                            <i uib-tooltip="Shipment template name"
                               tooltip-append-to-body="true"
                               tooltip-trigger="mouseenter"
                               tooltip-placement="top"
                               class="fa fa-info-circle"></i>
                        </label>
                        <label class="control-label pull-right text-error">*</label>
                        <input ng-model="AutoStartShipment.shipmentTemplateName"
                               type="text" name="TemplateName"
                               class="form-control" required maxlength="50"
                               placeholder="Enter shipment template name" />
                        <span ng-if="frmAddEditTemplate.$invalid && frmAddEditTemplate.$submitted" ng-cloak>
                            <span ng-cloak class="text-danger"
                                  ng-if="frmAddEditTemplate.TemplateName.$error.required">Please enter tmeplate name</span>
                             <span ng-cloak class="text-danger"
                                   ng-if="frmAddEditTemplate.TemplateName.$error.maxlength">Template name must be less than or equal to 60 chars</span>
                        </span>
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="portlet-title">
                    <div class="caption">
                        <h3 class="caption-subject font-green-sharp bold">1. Goods being monitored</h3>
                    </div>
                    <hr />
                </div>
                <div class="form-group">
                    <div class="col-sm-4">
                        <label class="control-label pull-left">
                            <span>Shipment Description:</span>
                            <i uib-tooltip="Shipment Description(Trip name / PO num / Load identity / etc)"
                               tooltip-append-to-body="true"
                               tooltip-trigger="mouseenter"
                               tooltip-placement="top"
                               class="fa fa-info-circle"></i>
                        </label>
                        <label class="control-label pull-right"><span class="text-error">*</span></label>
                        <div class="clearfix"></div>
                        <input ng-model="AutoStartShipment.shipmentDescription"
                               type="text" name="desc"
                               required
                               maxlength="120"
                               type="text"
                               class="form-control"
                               placeholder="Enter Shipment Description" />
                        <span ng-if="frmAddEditTemplate.$invalid && frmAddEditTemplate.$submitted" ng-cloak>
                            <span ng-cloak class="text-danger" ng-if="frmAddEditTemplate.desc.$error.required">Please enter template description</span>
                            <span ng-cloak class="text-danger" ng-if="frmAddEditTemplate.desc.$error.maxlength">Template description must be less than or equal to 120 chars</span>
                        </span>
                    </div>
                    <div class="col-sm-4 control-label" style="text-align:left">
                        <br />
                        <span class="hidden-xs">-&nbsp;&nbsp;&nbsp;&nbsp;</span>
                        <span>
                            <input type="checkbox" ng-model="AutoStartShipment.addDateShipped"
                                   id="add-date-shipped">
                            Add date shipped to shipment Description
                        </span>
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="portlet-title">
                    <div class="caption">
                        <h3 class="caption-subject font-green-sharp bold">2. Route</h3>
                    </div>
                    <hr />
                </div>
                <div class="row">
                    <div class="col-sm-4">
                        <div class="form-group">
                            <div class="container-fluid">
                                <label class="control-label">Options for auto-detection of Shipment From&nbsp;
                                    <i uib-tooltip="Options for auto-detection of Shipment From"
                                       tooltip-append-to-body="true" tooltip-trigger="mouseenter"
                                       tooltip-placement="top" class="fa fa-info-circle">
                                    </i>
                                </label>
                                <br />
                                <!--ng-change="ChangeNotiScheduleForArrival()"-->
                                <ui-select multiple
                                           on-select="VerifyStartLocations()"
                                           ng-model="AutoStartShipment.start_locations"
                                           theme="select2"
                                           ng-disabled="disabled"
                                           style="width:100%">
                                    <ui-select-match placeholder="Select location for auto detection of shipmentFrom">
                                        {{$item.DisplayText}}
                                    </ui-select-match>
                                    <ui-select-choices repeat="loc in FromLocationList | propsFilter: {locationId: $select.search, DisplayText: $select.search}">
                                        <div ng-bind-html="loc.DisplayText | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>

                                <!--<select style="width:100%"
                                    multiple ui-select2="OptionsShipmentFrom"
                                    ng-model="AutoStartShipment.startLocations"
                                    data-placeholder="Select location for auto detection of shipmentFrom">
                                    <option ng-repeat="location in FromLocationList"
                                            value="{{location.locationId}}">{{location.DisplayText}}</option>
                                </select>-->
                                <br />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <div class="container-fluid">
                                <label class="control-label">Options for auto-detection of Interim Stop
                                    <i uib-tooltip="Options for auto-detection of Interim Stop"
                                       tooltip-append-to-body="true" tooltip-trigger="mouseenter"
                                       tooltip-placement="top" class="fa fa-info-circle">
                                    </i>
                                </label>
                                <br />
                                <ui-select multiple
                                           on-select="VerifyInterimLocations()"
                                           ng-model="AutoStartShipment.interim_stops"
                                           theme="select2"
                                           ng-disabled="disabled"
                                           style="width:100%">
                                    <ui-select-match placeholder="Select location for auto detection of interim stops">
                                        {{$item.DisplayText}}
                                    </ui-select-match>
                                    <ui-select-choices repeat="loc in InterimLocationList | propsFilter: {locationId: $select.search, DisplayText: $select.search}">
                                        <div ng-bind-html="loc.DisplayText | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>
                                <!--<select style="width:100%"
                                        multiple ui-select2="OptionsShipmentFrom"
                                        ng-model="AutoStartShipment.interimStops"
                                        data-placeholder="Select location for auto detection of shipmentFrom">
                                    <option ng-repeat="location in InterimLocationList"
                                            value="{{location.locationId}}">{{location.DisplayText}}</option>
                                </select>-->
                                <br />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <div class="container-fluid">
                                <label class="control-label">Options for auto-detection of Shipment To&nbsp;
                                    <i uib-tooltip="Options for auto-detection of Shipment To"
                                       tooltip-append-to-body="true"
                                       tooltip-trigger="mouseenter"
                                       tooltip-placement="top"
                                       class="fa fa-info-circle"/>
                                </label>
                                <ui-select multiple
                                           on-select="VerifyEndLocations()"
                                           ng-model="AutoStartShipment.end_locations"
                                           theme="select2"
                                           ng-disabled="disabled"
                                           style="width:100%">
                                    <ui-select-match placeholder="Select location for auto detection of shipment to">
                                        {{$item.DisplayText}}
                                    </ui-select-match>
                                    <ui-select-choices repeat="loc in ToLocationList | propsFilter: {locationId: $select.search, DisplayText: $select.search}">
                                        <div ng-bind-html="loc.DisplayText | highlight: $select.search"></div>
                                    </ui-select-choices>
                                </ui-select>

                                <!--<select style="width:100%"
                                        multiple ui-select2="OptionsShipmentTo"
                                        ng-model="AutoStartShipment.endLocations"
                                        data-placeholder="Select location for auto detection of shipment to">
                                    <option ng-repeat="location in ToLocationList"
                                            value="{{location.locationId}}">{{location.DisplayText}}</option>
                                </select>-->
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6" style="display:none;">
                        <div class="col-sm-12">
                            <div id="map" style="width:100%;height:200px"></div>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="portlet-title">
                    <div class="caption">
                        <h3 class="caption-subject font-green-sharp bold">3. Alerts</h3>
                    </div>
                    <hr />
                </div>
                <div class="form-group">
                    <div class="col-sm-4">
                        <label class="control-label">Alert Profile&nbsp;
                            <i uib-tooltip="Alert Profile" tooltip-append-to-body="true" tooltip-trigger="mouseenter" tooltip-placement="top" class="fa fa-info-circle"/>
                        </label>
                        <select ng-model="AutoStartShipment.alertProfileId"
                                ng-change="CreateAlertRule()"
                                ng-options="alert.alertProfileId as alert.alertProfileName for alert in AlertList" class="form-control input-sm">
                            <option value="">-- Please Select --</option>
                        </select>
                        <small class="text-muted">
                            {{alertRuleListForSelectedAlertProfile}}
                        </small>
                    </div>
                    <div class="col-sm-1 control-label" style="text-align:left">
                        <br />
                        <a href=""><i class="fa fa-pencil" ng-click="openEditAlert(AutoStartShipment.alertProfileId)" tooltip="Edit this Alert Profile" tooltip-append-to-body="true" tooltip-trigger="mouseenter" tooltip-placement="top"></i></a>
                        &nbsp;
                        <a href=""><i class="fa fa-plus" ng-click="openAddAlert()" tooltip="Add new Alert Profile" tooltip-append-to-body="true" tooltip-trigger="mouseenter" tooltip-placement="top"></i></a>
                    </div>
                    <div class="col-sm-12 visible-xs">&nbsp;</div>
                    <div class="col-sm-2">
                        <label class="control-label">Alert Suppression in cooldown&nbsp;
                            <i uib-tooltip="Alert suppression during cool down" tooltip-append-to-body="true" tooltip-trigger="mouseenter" tooltip-placement="top" class="fa fa-info-circle"></i></label>
                        <div class="btn-group" role="group">
                            <button type="button"
                                    ng-class="{'active':AutoStartShipment.alertSuppressionMinutes==0}"
                                    ng-model="AutoStartShipment.alertSuppressionDuringCoolDown"
                                    ng-click="AutoStartShipment.alertSuppressionMinutes = 0"
                                    class="btn btn-default">0 hrs</button>
                            <button type="button"
                                    ng-class="{'active':AutoStartShipment.alertSuppressionMinutes==120}"
                                    ng-model="AutoStartShipment.alertSuppressionDuringCoolDown"
                                    ng-click="AutoStartShipment.alertSuppressionMinutes = 120"
                                    class="btn btn-default">2 hrs</button>
                            <button type="button"
                                    ng-class="{'active':AutoStartShipment.alertSuppressionMinutes==240}"
                                    ng-model="AutoStartShipment.alertSuppressionDuringCoolDown"
                                    ng-click="AutoStartShipment.alertSuppressionMinutes = 240"
                                    class="btn btn-default">4 hrs</button>
                        </div>
                    </div>
                    <div class="col-sm-12 visible-xs">&nbsp;</div>

                    <div class="col-sm-4">
                        <label class="control-label">
                            <span>Notification Schedule(s) For Alerts</span>
                            <i uib-tooltip="Notification schedule(s) for alerts"
                               tooltip-append-to-body="true"
                               tooltip-trigger="mouseenter"
                               tooltip-placement="top"
                               class="fa fa-info-circle"/>
                        </label>

                        <ui-select multiple
                                   on-select="ChangeNotiScheduleForAlert()"
                                   ng-model="AutoStartShipment.alerts_notification_schedules"
                                   theme="select2"
                                   ng-disabled="disabled"
                                   style="width:100%">
                            <ui-select-match placeholder="Select Notification Schedule For Alert Profile">
                                {{$item.notificationScheduleName}}
                            </ui-select-match>
                            <ui-select-choices repeat="noti in NotificationList | propsFilter: {notificationScheduleId: $select.search, notificationScheduleName: $select.search}">
                                <div ng-bind-html="noti.notificationScheduleName | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>

                        <!--<select style="width:100%"
                                ng-change="ChangeNotiScheduleForAlert()"
                                multiple ui-select2="NotificationScheduleOption"
                                ng-model="AutoStartShipment.alertsNotificationSchedules"
                                data-placeholder="Select Notification Schedule For Alert Profile">
                            <option ng-repeat="noti in NotificationList"
                                    value="{{noti.notificationScheduleId}}">{{noti.notificationScheduleName}}</option>
                        </select>-->
                        <small class="text-muted control-label">
                            {{AlertNotiRule}}
                        </small>
                    </div>
                    <div class="col-sm-1 control-label" style="text-align:left">
                        <br />
                        <a href=""><i class="fa fa-pencil" ng-click="openEditNoti(AutoStartShipment.alertsNotificationSchedules)" tooltip="Edit this Notification Schedule" tooltip-append-to-body="true" tooltip-trigger="mouseenter" tooltip-placement="top"></i></a>
                        &nbsp;
                        <a href=""><i class="fa fa-plus" ng-click="openAddNoti()" tooltip="Add new Notification Schedule" tooltip-append-to-body="true" tooltip-trigger="mouseenter" tooltip-placement="top"></i></a>
                    </div>
                </div>


                <div class="form-group">
                    <div class="col-sm-4">
                        <label class="control-label">Suppress All Alert On Arrival&nbsp;
                            <i uib-tooltip="No alert after arrival minutes"
                               tooltip-append-to-body="true"
                               tooltip-trigger="mouseenter"
                               tooltip-placement="top"
                               class="fa fa-info-circle"/>
                        </label>
                        <select class="form-control" ng-model="AutoStartShipment.noAlertsAfterArrivalMinutes">
                            <option value="">Don't suppress on arrival</option>
                            <option value="0">Suppress On Arrival</option>
                            <option value="60">Suppress After 1 hr at destination</option>
                            <option value="120">Suppress After 2 hr at destination</option>
                            <option value="240">Suppress After 4 hr at destination</option>
                            <option value="480">Suppress After 8 hr at destination</option>
                        </select>
                    </div>
                    <div class="col-sm-4">
                        <label class="control-label">
                            Suppress All Alerts After Time Period
                            <i uib-tooltip="Do not fire any alerts after this period of time"
                               tooltip-append-to-body="true"
                               tooltip-trigger="mouseenter"
                               tooltip-placement="top"
                               class="fa fa-info-circle"/>
                        </label>
                        <select class="form-control" ng-model="AutoStartShipment.noAlertsAfterStartMinutes">
                            <option value="">Don't suppress after time period</option>
                            <option value="240">Suppress 4 hrs after start</option>
                            <option value="480">Suppress 8 hrs after start</option>
                            <option value="720">Suppress 12 hrs after start</option>
                            <option value="1080">Suppress 18 hrs after start</option>
                            <option value="1440">Suppress 1 day after start</option>
                            <option value="2880">Suppress 2 days after start</option>
                            <option value="4320">Suppress 3 days after start</option>
                            <option value="7200">Suppress 5 days after start</option>
                            <option value="14400">Suppress 10 days after start</option>
                            <option value="28800">Suppress 20 days after start</option>
                        </select>
                    </div>
                </div>


                <div class="clearfix"></div>
                <div class="portlet-title">
                    <div class="caption">
                        <h3 class="caption-subject font-green-sharp bold">4. On arrival</h3>
                    </div>
                    <hr />
                </div>
                <div class="form-group">
                    <div class="col-sm-4">
                        <label class="control-label">Comments For Receiver&nbsp;
                            <i uib-tooltip="Comments for Receiver" tooltip-append-to-body="true" tooltip-trigger="mouseenter" tooltip-placement="top" class="fa fa-info-circle"/>
                        </label>
                        <textarea maxlength="300"
                                  name="comment"
                                  class="form-control"
                                  ng-model="AutoStartShipment.commentsForReceiver"
                                  placeholder="Tracker is located on last pallet loaded into trailer. Please collect tracker and hand to driver for return."/>
                        <span ng-if="frmAddEditTemplate.$invalid" ng-cloak>
                            <span ng-cloak class="text-danger" ng-if="frmAddEditTemplate.comment.$error.maxlength">Comment for receiver must be less than or equal to 300 chars</span>
                        </span>
                    </div>
                    <div class="col-sm-12 visible-xs">&nbsp;</div>
                    <div class="col-sm-3">
                        <label class="control-label">Arrival Notification&nbsp;
                            <i uib-tooltip="Arrival notification" tooltip-append-to-body="true" tooltip-trigger="mouseenter" tooltip-placement="top" class="fa fa-info-circle"/>
                        </label>
                        <select class="form-control " ng-model="AutoStartShipment.arrivalNotificationWithinKm">
                            <option value="">No notification needed</option>
                            <option value="50">Less than 50 kms away</option>
                            <option value="25">Less than 25 kms away</option>
                            <option value="10">Less than 10 kms away</option>
                            <option value="5">Less than 5 kms away</option>
                            <option value="0">At Destination</option>
                        </select>
                        <label class="checkbox-inline" for="exc-noti">
                            <input ng-model="AutoStartShipment.excludeNotificationsIfNoAlerts" type="checkbox" id="exc-noti">
                                Only notify if alerts fired&nbsp;
                                <i uib-tooltip="Exclude Notification" tooltip-append-to-body="true" tooltip-trigger="mouseenter" tooltip-placement="top" class="fa fa-info-circle"/>
                        </label>
                    </div>
                    <div class="col-sm-12 visible-xs">&nbsp;</div>
                    <div class="col-sm-4">
                        <label class="control-label">
                            <span>Schedule(s) For Arrival Notification</span>
                            <i uib-tooltip="Schedule(s) for arrival notification"
                               tooltip-append-to-body="true"
                               tooltip-trigger="mouseenter"
                               tooltip-placement="top"
                               class="fa fa-info-circle"/>
                        </label>
                        <ui-select multiple
                                   on-select="ChangeNotiScheduleForArrival()"
                                   ng-model="AutoStartShipment.arrival_notification_schedules"
                                   theme="select2"
                                   ng-disabled="disabled"
                                   style="width:100%">
                            <ui-select-match placeholder="Select Notification Schedule For Arrival">
                                {{$item.notificationScheduleName}}
                            </ui-select-match>
                            <ui-select-choices repeat="noti in NotificationList | propsFilter: {notificationScheduleId: $select.search, notificationScheduleName: $select.search}">
                                <div ng-bind-html="noti.notificationScheduleName | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>

                        <!--<select style="width:100%"
                                ng-change="ChangeNotiScheduleForArrival()"
                                multiple ui-select2="NotificationScheduleOption"
                                ng-model="AutoStartShipment.arrivalNotificationSchedules"
                                data-placeholder="Select Notification Schedule For Arrival">
                            <option ng-repeat="noti in NotificationList"
                                    value="{{noti.notificationScheduleId}}">{{noti.notificationScheduleName}}</option>
                        </select>-->
                        <br />
                        <small class="text-muted control-label">
                            {{ArrivalNotiRule}}
                        </small>
                    </div>
                    <div class="col-sm-1 control-label" style="text-align:left">
                        <br />
                        <a href="">
                            <i class="fa fa-pencil" ng-click="openEditNoti(AutoStartShipment.arrivalNotificationSchedules)"
                               tooltip="Edit this Notification Schedule"
                               tooltip-append-to-body="true"
                               tooltip-trigger="mouseenter"
                               tooltip-placement="top"/></a>&nbsp;
                        <a href="">
                            <i class="fa fa-plus" ng-click="openAddNoti()"
                               tooltip="Add new Notification Schedule"
                               tooltip-append-to-body="true"
                               tooltip-trigger="mouseenter"
                               tooltip-placement="top"/></a>
                    </div>
                    <div class="col-sm-12">&nbsp;</div>
                    <div class="col-sm-4">
                        <label class="control-label">Shutdown Device On Arrival
                            <i uib-tooltip="Shutdown device after minutes"
                               tooltip-append-to-body="true"
                               tooltip-trigger="mouseenter"
                               tooltip-placement="top"
                               class="fa fa-info-circle"/>
                        </label>
                        <select class="form-control " ng-model="AutoStartShipment.shutdownDeviceAfterMinutes">
                            <option value="">Don't Shutdown on Arrival</option>
                            <option value="0">Shutdown upon Arrival</option>
                            <option value="60">Shutdown After 1 hr at destination</option>
                            <option value="120">Shutdown After 2 hr at destination</option>
                            <option value="240">Shutdown After 4 hr at destination</option>
                            <option value="480">Shutdown After 8 hr at destination</option>
                        </select>
                    </div>
                    <div class="col-sm-4">
                        <label class="control-label">
                            Shutdown Device After Time Period
                            <i uib-tooltip="Shutdown after start minutes"
                               tooltip-append-to-body="true"
                               tooltip-trigger="mouseenter"
                               tooltip-placement="top"
                               class="fa fa-info-circle"/>
                        </label>
                        <select class="form-control" ng-model="AutoStartShipment.shutDownAfterStartMinutes">
                            <option value="">Don't shutdown after time period</option>
                            <option value="240">Shutdown 4 hrs after start</option>
                            <option value="480">Shutdown 8 hrs after start</option>
                            <option value="720">Shutdown 12 hrs after start</option>
                            <option value="1080">Shutdown 18 hrs after start</option>
                            <option value="1440">Shutdown 1 day after start</option>
                            <option value="2880">Shutdown 2 days after start</option>
                            <option value="4320">Shutdown 3 days after start</option>
                            <option value="7200">Shutdown 5 days after start</option>
                            <option value="14400">Shutdown 10 days after start</option>
                            <option value="28800">Shutdown 20 days after start</option>
                        </select>
                    </div>

                </div>
                <div class="clearfix"></div>
            </div>
            <div class="clearfix"></div>
            <div class="col-sm-12">
                <hr />
            </div>
            <div class="clearfix"></div>
            <div class="form-actions text-center">
                <button class="btn green" ng-click="SaveData(frmAddEditTemplate.$valid)" type="submit">Save</button>
                <button class="btn default" type="button" ui-sref="manage.autotemp">Cancel</button>
            </div>
        </form>
    </div>
</div>
